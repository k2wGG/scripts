// ==UserScript==
// @name          GetUranium AutoBoost v2
// @namespace     https://github.com/k2wGG
// @version       2.9.1
// @description   –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±—É—Å—Ç–µ—Ä–æ–≤, —Å–±–æ—Ä —Ñ–µ—Ä–º—ã, –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π keep-alive –∏ –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è GetUranium.io.
// @author        k2wGG
// @match         https://geturanium.io/*
// @match         https://www.geturanium.io/*
// @run-at        document-start
// @grant         none
// @inject-into   page //–ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç—É —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
// ==/UserScript==

;(function(){
  'use strict';
  console.info('üöÄ AutoBoost v2.9.1 –∑–∞–≥—Ä—É–∂–µ–Ω. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã.');

  /* ---------------------------------------------------------------
   * 0) –ì–õ–£–ë–û–ö–ò–ï –ü–ê–¢–ß–ò –î–õ–Ø –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ô –ò–ú–ò–¢–ê–¶–ò–ò –ê–ö–¢–ò–í–ù–û–°–¢–ò –ò –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò
   * ------------------------------------------------------------- */

  // 0.1) –ü–∞—Ç—á Event.isTrusted: –î–µ–ª–∞–µ–º –≤—Å–µ —ç–º—É–ª–∏—Ä—É–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è "–¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏"
  // –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –æ–±—Ö–æ–¥–∞ –º–Ω–æ–≥–∏—Ö –∞–Ω—Ç–∏-–±–æ—Ç —Å–∏—Å—Ç–µ–º –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã UI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ (–≤—Ä–æ–¥–µ React).
  if(!Event.prototype.__ab_trusted){
    [Event, MouseEvent, KeyboardEvent, UIEvent].forEach(C=>{
      try {
        Object.defineProperty(C.prototype,'isTrusted',{
          get(){ return true; },
          configurable:true // –í–∞–∂–Ω–æ: –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ, –µ—Å–ª–∏ –æ–Ω–æ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É—Å–ø–µ—Ö.
        });
      } catch (e) {
        console.warn(`[AutoBoost Pro] –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å Event.isTrusted –¥–ª—è ${C.name}:`, e);
      }
    });
    Event.prototype.__ab_trusted = true;
    console.info('[AutoBoost Pro] Event.isTrusted —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–ø–∞—Ç—á–µ–Ω: –≤—Å–µ–≥–¥–∞ true.');
  }

  // 0.2) –ü–∞—Ç—á requestAnimationFrame (RAF) –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  // –¶–µ–ª—å: –û–±–º–∞–Ω—É—Ç—å –ª–æ–≥–∏–∫—É —Å–∞–π—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏/—Ä–∞—Å—á–µ—Ç—ã –≤ —Å–∫—Ä—ã—Ç—ã—Ö –≤–∫–ª–∞–¥–∫–∞—Ö.
  // –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—É—Ç–µ–º —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∫–æ–ª–±—ç–∫–æ–≤ RAF, –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞.
  if (window.requestAnimationFrame && !window.requestAnimationFrame.__ab_patched) {
    const _originalRequestAnimationFrame = window.requestAnimationFrame;
    let lastRafTime = performance.now(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ç–µ–∫—É—â–∏–º –≤—Ä–µ–º–µ–Ω–µ–º
    const RAF_MIN_INTERVAL = 1000 / 60; // ‚âà 60 –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É

    window.requestAnimationFrame = function(callback) {
      const now = performance.now();
      // –ï—Å–ª–∏ –≤–∫–ª–∞–¥–∫–∞ —Å–∫—Ä—ã—Ç–∞ –ò –ø—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ RAF,
      // –º—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–±—ç–∫.
      if (document.hidden && (now - lastRafTime >= RAF_MIN_INTERVAL)) {
          lastRafTime = now; // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
          try {
              callback(now); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–±—ç–∫ —Å —Ç–µ–∫—É—â–∏–º –≤—Ä–µ–º–µ–Ω–µ–º
          } catch (e) {
              console.error('[AutoBoost v2] –û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ RAF –∫–æ–ª–±—ç–∫–∞:', e);
          }
      }
      // –í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π requestAnimationFrame.
      // –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É —É–ø—Ä–∞–≤–ª—è—Ç—å —Ü–∏–∫–ª–æ–º RAF, –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞,
      // –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∞–π—Ç—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –∫–æ–ª–±—ç–∫–∏.
      return _originalRequestAnimationFrame.call(window, callback);
    };
    window.requestAnimationFrame.__ab_patched = true;
    console.info('[AutoBoost v2] requestAnimationFrame –ø—Ä–æ–ø–∞—Ç—á–µ–Ω –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.');
  }

  // 0.3) –ü–∞—Ç—á setTimeout/setInterval –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ç–∞–π–º–∏–Ω–≥–∞ –≤ –ª—é–±—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –≤–∫–ª–∞–¥–∫–∏
  // –¶–µ–ª—å: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å "–¥—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ" (–∑–∞–º–µ–¥–ª–µ–Ω–∏–µ) —Ç–∞–π–º–µ—Ä–æ–≤ –±—Ä–∞—É–∑–µ—Ä–æ–º –¥–æ 1 —Å–µ–∫—É–Ω–¥—ã
  // –¥–ª—è —Å–∫—Ä—ã—Ç—ã—Ö –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫.
  if (!window.__ab_timers_patched) {
    const MIN_INTERVAL_MS = 4; // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ç–∞–π–º–µ—Ä–æ–≤ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö

    const _originalSetTimeout = window.setTimeout;
    window.setTimeout = function(callback, delay = 0, ...args) {
      return _originalSetTimeout.call(this, callback, Math.max(delay, MIN_INTERVAL_MS), ...args);
    };

    const _originalSetInterval = window.setInterval;
    window.setInterval = function(callback, delay = 0, ...args) {
      return _originalSetInterval.call(this, callback, Math.max(delay, MIN_INTERVAL_MS), ...args);
    };
    window.__ab_timers_patched = true;
    console.info('[AutoBoost v2] setTimeout/setInterval –ø—Ä–æ–ø–∞—Ç—á–µ–Ω—ã –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ç–∞–π–º–∏–Ω–≥–æ–≤.');
  }

  // 0.4) –ü–∞—Ç—á document.hasFocus() –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ñ–æ–∫—É—Å–∞ –æ–∫–Ω–∞
  // –¶–µ–ª—å: –ó–∞—Å—Ç–∞–≤–∏—Ç—å —Å–∞–π—Ç –¥—É–º–∞—Ç—å, —á—Ç–æ –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–æ–∫—É—Å–µ,
  // –æ–±—Ö–æ–¥—è –ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞.
  if (document.hasFocus && !document.hasFocus.__ab_patched) {
    const _originalHasFocus = document.hasFocus;
    document.hasFocus = function() {
      // –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º true. –≠—Ç–æ –Ω–µ –º–µ–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ñ–æ–∫—É—Å–∞, –Ω–æ –æ–±–º–∞–Ω—ã–≤–∞–µ—Ç JS.
      return true;
    };
    document.hasFocus.__ab_patched = true;
    console.info('[AutoBoost v2] document.hasFocus() –ø—Ä–æ–ø–∞—Ç—á–µ–Ω: –≤—Å–µ–≥–¥–∞ true.');
  }

  /* ---------------------------------------------------------------
   * 1) –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –°–æ—Å—Ç–æ—è–Ω–∏–µ (localStorage / sessionStorage)
   * ------------------------------------------------------------- */
  const DEF = {
    enabled:         true,
    autoAC:          true, // Auto Collector
    autoSM:          true, // Shard Multiplier
    autoCB:          true, // Conveyor Booster
    autoFarm:        true, // Farm Reward
    keepAlive:       true, // Keep-Alive (–∏–º–∏—Ç–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)
    autoReload:      true, // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    reloadMinutes:   50,   // –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
    logEach:         10    // –ò–Ω—Ç–µ—Ä–≤–∞–ª –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å
  };
  const LS_CFG    = 'gu-autoboost-config';
  const LS_STATS = 'gu-autoboost-stats';

  let cfg   = loadConfig();
  let stats = loadStats();

  /** –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ localStorage */
  function loadConfig(){
    try{ return {...DEF, ...JSON.parse(localStorage.getItem(LS_CFG)||'{}')}; }
    catch(e){ console.error('[AutoBoost v2] –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞:',e); return {...DEF}; }
  }
  /** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ localStorage */
  function saveConfig(){ localStorage.setItem(LS_CFG, JSON.stringify(cfg)); }

  /** –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ sessionStorage */
  function loadStats(){
    try{
      return JSON.parse(sessionStorage.getItem(LS_STATS)) || {
        reloadCount: 0,
        clickCount: { autoAC:0, autoSM:0, autoCB:0, autoFarm:0 }
      };
    }catch(e){
      console.error('[AutoBoost v2] –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:',e);
      return { reloadCount: 0, clickCount:{autoAC:0,autoSM:0,autoCB:0,autoFarm:0} };
    }
  }
  /** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ sessionStorage */
  function saveStats(){ sessionStorage.setItem(LS_STATS, JSON.stringify(stats)); }

  /** –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ */
  const rnd = (min,max)=> min + Math.random()*(max-min)|0;

  /* ---------------------------------------------------------------
   * 2) Soft Keep-Alive ‚Äî –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
   * ------------------------------------------------------------- */
  setInterval(()=>{
    if(!cfg.keepAlive) return;

    // –ò–Ω–∏—Ü–∏–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –æ–±—Ö–æ–¥–∞ AFK –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    fetch('/favicon.ico',{cache:'no-store',mode:'no-cors'}).catch(()=>{});

    const body = document.body;
    if (body) {
      const rect = body.getBoundingClientRect();
      const x = rect.left + Math.random()*rect.width;
      const y = rect.top¬† + Math.random()*rect.height;

      // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–µ–∫—Ç—Ä —Å–æ–±—ã—Ç–∏–π –º—ã—à–∏ –∏ —É–∫–∞–∑–∞—Ç–µ–ª—è
      ['mousemove', 'mousedown', 'mouseup', 'click', 'pointermove', 'pointerdown', 'pointerup'].forEach(type => {
        // isTrusted —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ç—á–µ–º 0.1
        body.dispatchEvent(new MouseEvent(type, {
          bubbles:true, cancelable:true, view:window,
          button:0, buttons:(type==='mousedown'||type==='pointerdown')?1:0,
          clientX:x, clientY:y
        }));
      });
    }

    // –ò–º–∏—Ç–∏—Ä—É–µ–º –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.scrollBy(0, rnd(-1,1));

    // –ò–º–∏—Ç–∏—Ä—É–µ–º –Ω–∞–∂–∞—Ç–∏—è –∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è –∫–ª–∞–≤–∏—à
    document.dispatchEvent(new KeyboardEvent('keydown',{key:' ',code:'Space',bubbles:true}));
    document.dispatchEvent(new KeyboardEvent('keyup'¬† ,{key:' ',code:'Space',bubbles:true}));

    // –ò–º–∏—Ç–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏—è —Ñ–æ–∫—É—Å–∞/–ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    // –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–∞—Ç—á document.hasFocus(), –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –º–æ–≥—É—Ç –Ω–∞–ø—Ä—è–º—É—é —Å–ª—É—à–∞—Ç—å —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è.
    document.dispatchEvent(new Event('focus', {bubbles:true}));
    document.dispatchEvent(new Event('blur', {bubbles:true})); // –ú–æ–∂–Ω–æ dispatch'–∏—Ç—å focus/blur –ø–æ –æ—á–µ—Ä–µ–¥–∏, –∏–ª–∏ —Ç–æ–ª—å–∫–æ focus

  }, rnd(90,120)*1000); // –ò–Ω—Ç–µ—Ä–≤–∞–ª –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ 90-120 —Å–µ–∫—É–Ω–¥

  /* ---------------------------------------------------------------
   * 3) –ü–µ—Ä–µ—Ö–≤–∞—Ç fetch ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 429 / 403
   * ------------------------------------------------------------- */
  let backoffUntil = 0;
  const nativeFetch = window.fetch.bind(window); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π fetch
  window.fetch = async (...args) => {
    try {
      const res = await nativeFetch(...args);
      if(res.status===429){
        backoffUntil = Date.now()+5*60*1000; // –ü–∞—É–∑–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç –ø—Ä–∏ 429 Too Many Requests
        console.warn('[AutoBoost v2] –û–±–Ω–∞—Ä—É–∂–µ–Ω 429 (Too Many Requests) ‚Üí —Å—Ç–∞–≤–∏–º –ø–∞—É–∑—É 5 –º–∏–Ω.');
      }
      if(res.status===403){
        console.warn('[AutoBoost v2] –û–±–Ω–∞—Ä—É–∂–µ–Ω 403 (Forbidden) ‚Üí –≤—ã–ø–æ–ª–Ω—è–µ–º –∂—ë—Å—Ç–∫—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É.');
        hardReload(); // –ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ 403 Forbidden
      }
      return res;
    } catch (error) {
      console.error('[AutoBoost v2] –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ fetch –∑–∞–ø—Ä–æ—Å–∞:', error);
      // –í–æ–∑–º–æ–∂–Ω–æ, —Ç–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Offline)
      throw error; // –ü–µ—Ä–µ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É fetch
    }
  };

  /* ---------------------------------------------------------------
   * 4) –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫ –±—É—Å—Ç–µ—Ä–æ–≤ + —Å–±–æ—Ä —Ñ–µ—Ä–º—ã
   * ------------------------------------------------------------- */
  const LABELS = {
    autoAC¬† : 'auto collector',
    autoSM¬† : 'shard multiplier',
    autoCB¬† : 'conveyor booster',
    autoFarm: 'farm reward'
  };
  const timers¬† ¬†= {}; // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
  const lastClick= {}; // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–ª–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–µ
  const nextLog¬† = { value: Date.now() }; // –î–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

  /** –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ –Ω–∞—á–∞–ª—É –µ—ë —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ */
  function findBtn(text){
    return [...document.querySelectorAll('button')]
      .find(b => b.innerText.toLowerCase().startsWith(text.toLowerCase()));
  }

  /** –ü–∞—Ä—Å–∏–Ω–≥ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –≤—Ä–µ–º–µ–Ω–∏ –∫—É–ª–¥–∞—É–Ω–∞ –∫–Ω–æ–ø–∫–∏ */
  function getCooldown(btn){
    if(!btn || btn.disabled===false) return 0; // –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if(/activating/i.test(btn.innerText)) return 3000; // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "activating"
    const m = /(\d+)\s*m.*?(\d+)\s*s/i.exec(btn.innerText); // –ü–∞—Ä—Å–∏–º "Xm Ys"
    if(m) return (60*+m[1] + +m[2])*1000;
    const s = /(\d+)\s*s/i.exec(btn.innerText); // –ü–∞—Ä—Å–∏–º "Xs"
    if(s) return (+s[1])*1000;
    return 600000; // –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫—É–ª–¥–∞—É–Ω 10 –º–∏–Ω—É—Ç, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å
  }

  /** –≠–º—É–ª—è—Ü–∏—è "—á–µ—Å—Ç–Ω–æ–≥–æ" –∫–ª–∏–∫–∞ –ø–æ DOM-—ç–ª–µ–º–µ–Ω—Ç—É */
  function doClick(el){
    if(!el) {
      console.warn('[AutoBoost v2] –ü–æ–ø—ã—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.');
      return;
    }
    const rect = el.getBoundingClientRect();
    if(!rect.width||!rect.height) {
      console.warn('[AutoBoost v2] –ü–æ–ø—ã—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –Ω–µ–≤–∏–¥–∏–º–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É (–Ω—É–ª–µ–≤–∞—è —à–∏—Ä–∏–Ω–∞/–≤—ã—Å–æ—Ç–∞).');
      return;
    }
    const x = rect.left + Math.random()*rect.width;  // –°–ª—É—á–∞–π–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–Ω–æ–ø–∫–∏
    const y = rect.top¬† + Math.random()*rect.height; // –°–ª—É—á–∞–π–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–Ω–æ–ø–∫–∏

    // –î–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–∫–∞
    // isTrusted: true –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞—à–∏–º –ø–∞—Ç—á–µ–º 0.1
    ['mousedown','mouseup','click'].forEach(type=>
      el.dispatchEvent(new MouseEvent(type,{
        bubbles:true,      // –°–æ–±—ã—Ç–∏–µ –≤—Å–ø–ª—ã–≤–∞–µ—Ç
        cancelable:true,   // –°–æ–±—ã—Ç–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–æ
        view:window,       // –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞, –≥–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å–æ–±—ã—Ç–∏–µ
        button:0,          // –û—Å–Ω–æ–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –º—ã—à–∏ (–ª–µ–≤–∞—è)
        buttons:type==='mousedown'?1:0, // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ (1 - –Ω–∞–∂–∞—Ç–∞ –ª–µ–≤–∞—è)
        clientX:x,clientY:y // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–ª–∏–∫–∞
      }))
    );
  }

  /** –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∫–ª–∏–∫–æ–≤ –¥–ª—è –±—É—Å—Ç–µ—Ä–æ–≤ –∏ —Ñ–µ—Ä–º—ã */
  function schedule(key){
    clearTimeout(timers[key]); // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä

    // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω –±—ç–∫–æ—Ñ—Ñ (–ø–æ—Å–ª–µ 429), –ø–ª–∞–Ω–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
    if(Date.now()<backoffUntil){
      timers[key] = setTimeout(()=>schedule(key), backoffUntil-Date.now()+1000);
      return;
    }
    // –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –≤—ã–∫–ª—é—á–µ–Ω –≤ UI, –ø—Ä–æ—Å—Ç–æ –∂–¥–µ–º 3 —Å–µ–∫—É–Ω–¥—ã
    if(!cfg.enabled){
      timers[key] = setTimeout(()=>schedule(key), 3000);
      return;
    }

    const btn = findBtn(LABELS[key]);
    const cd¬† = getCooldown(btn); // –ü–æ–ª—É—á–∞–µ–º –∫—É–ª–¥–∞—É–Ω –∫–Ω–æ–ø–∫–∏

    if(cd===0){ // –ï—Å–ª–∏ –∫—É–ª–¥–∞—É–Ω —Ä–∞–≤–µ–Ω 0 (–∫–Ω–æ–ø–∫–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∫–ª–∏–∫—É)
      const since = Date.now()-(lastClick[key]||0); // –í—Ä–µ–º—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–ª–∏–∫–∞
      const gap¬† ¬†= 8000 + rnd(0,2000); // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∫–ª–∏–∫–∞–º–∏ (8-10 —Å–µ–∫—É–Ω–¥)
      if(cfg[key] && btn && !btn.disabled && since>gap){ // –ï—Å–ª–∏ –æ–ø—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞, –∫–Ω–æ–ø–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ—à–ª–∞ –∑–∞–¥–µ—Ä–∂–∫–∞
        doClick(btn); // –í—ã–ø–æ–ª–Ω—è–µ–º –∫–ª–∏–∫
        lastClick[key] = Date.now(); // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–ª–∏–∫–∞
        stats.clickCount[key]++; saveStats(); updateStatsUI(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        log(`‚ö° ${key} –∫–ª–∏–∫–Ω—É—Ç.`); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ
      }
      timers[key] = setTimeout(()=>schedule(key),1000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É, –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –≥–æ—Ç–æ–≤–∞
    }else{
      const delay = cd + 1000 + rnd(0,1500); // –ü–ª–∞–Ω–∏—Ä—É–µ–º –∫–ª–∏–∫ –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫—É–ª–¥–∞—É–Ω–∞ + –Ω–µ–±–æ–ª—å—à–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
      log(`‚è≥ ${key}: —Å–ª–µ–¥—É—é—â–∏–π –∫–ª–∏–∫ —á–µ—Ä–µ–∑ ${Math.round(cd/1000)} —Å.`); // –õ–æ–≥–∏—Ä—É–µ–º –∫—É–ª–¥–∞—É–Ω
      timers[key] = setTimeout(()=>schedule(key), delay);
    }
  }
  /** –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∞–≤—Ç–æ-–∫–ª–∏–∫–æ–≤ (–∫—Ä–æ–º–µ —Ñ–µ—Ä–º—ã, –æ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ) */
  function startAll(){
    Object.keys(LABELS).forEach(key=> key!=='autoFarm' && schedule(key));
  }

  /* ---------------------------------------------------------------
   * 5) –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤–∫–ª–∞–¥–∫–∏
   * ------------------------------------------------------------- */
  let reloadTimer = null;
  function scheduleReload(){
    clearTimeout(reloadTimer); // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
    if(!cfg.autoReload) return; // –ï—Å–ª–∏ –æ–ø—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∞, –≤—ã—Ö–æ–¥–∏–º
    const ms = cfg.reloadMinutes*60*1000; // –í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
    console.info(`[AutoBoost v2] –°–ª–µ–¥—É—é—â–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ ${cfg.reloadMinutes} –º–∏–Ω.`);
    reloadTimer = setTimeout(()=>{
      stats.reloadCount++; saveStats(); updateStatsUI(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫
      hardReload(); // –í—ã–ø–æ–ª–Ω—è–µ–º –∂–µ—Å—Ç–∫—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É
    }, ms);
  }
  /** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∂–µ—Å—Ç–∫–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
  function hardReload(){
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∫ URL, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
    location.replace(location.pathname+'?_='+Date.now());
  }

  /* ---------------------------------------------------------------
   * 6) Keep-alive –¥–ª—è Vercel (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ edge-—Ñ—É–Ω–∫—Ü–∏–π)
   * ------------------------------------------------------------- */
  function scheduleVercel(){
    if(!cfg.keepAlive) return; // –ï—Å–ª–∏ Keep-Alive –≤—ã–∫–ª—é—á–µ–Ω
    const ms = rnd(50,55)*60*1000; // –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø–∏–Ω–≥–∞ Vercel (50-55 –º–∏–Ω—É—Ç)
    console.info(`[AutoBoost v2] –ü–∏–Ω–≥ Vercel —á–µ—Ä–µ–∑ ‚âà${Math.round(ms/60000)} –º–∏–Ω.`);
    setTimeout(()=>{
      // –°–æ–∑–¥–∞–µ–º –∏ —É–¥–∞–ª—è–µ–º –Ω–µ–≤–∏–¥–∏–º—ã–π iframe, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
      // –≠—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è "–∂–∏–≤–æ–µ" —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.
      const f=document.createElement('iframe');
      f.style.display='none'; f.src='/';
      document.body.append(f);
      setTimeout(()=>f.remove(),15000); // –£–¥–∞–ª—è–µ–º iframe —á–µ—Ä–µ–∑ 15 —Å–µ–∫—É–Ω–¥
      scheduleVercel(); // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π –ø–∏–Ω–≥
    }, ms);
  }

  /* ---------------------------------------------------------------
   * 7) –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä —Ñ–µ—Ä–º—ã —Ä–∞–∑ –≤ 8 —á–∞—Å–æ–≤
   * ------------------------------------------------------------- */
  let farmInterval = null;
  function doFarm(){
    if(!cfg.autoFarm) return; // –ï—Å–ª–∏ –∞–≤—Ç–æ-—Ñ–µ—Ä–º–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞
    const b = findBtn(LABELS.autoFarm); // –ò—â–µ–º –∫–Ω–æ–ø–∫—É —Ñ–µ—Ä–º—ã
    if(b && !b.disabled){ // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
      doClick(b); // –ö–ª–∏–∫–∞–µ–º –ø–æ –Ω–µ–π
      stats.clickCount.autoFarm++; saveStats(); updateStatsUI(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      console.info('[AutoBoost v2] üåæ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ —Ñ–µ—Ä–º—ã.');
    }
  }
  function scheduleFarm(){
    clearInterval(farmInterval); // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
    if(!cfg.autoFarm) return; // –ï—Å–ª–∏ –æ–ø—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∞
    doFarm(); // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–≤—ã–π —Å–±–æ—Ä —Å—Ä–∞–∑—É
    farmInterval = setInterval(doFarm, 8*60*60*1000 + rnd(0,5*60*1000)); // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–±–æ—Ä –∫–∞–∂–¥—ã–µ 8 —á–∞—Å–æ–≤ + —Å–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
  }

  /* ---------------------------------------------------------------
   * 8) –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞
   * ------------------------------------------------------------- */
  function init(){
    // –ñ–¥–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫.
    if(!findBtn(LABELS.autoAC) && !findBtn(LABELS.autoSM) && !findBtn(LABELS.autoCB)){
      requestAnimationFrame(init);
      return;
    }
    console.info('‚úÖ AutoBoost v2 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.');
    startAll();       // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª–∏–∫–∏ –ø–æ –±—É—Å—Ç–µ—Ä–∞–º
    scheduleReload(); // –ü–ª–∞–Ω–∏—Ä—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É
    scheduleVercel(); // –ó–∞–ø—É—Å–∫–∞–µ–º Keep-Alive –¥–ª—è Vercel
    scheduleFarm();   // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä —Ñ–µ—Ä–º—ã
  }

  /* ---------------------------------------------------------------
   * 9) –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —á–∞—Å—Ç–æ—Ç—ã
   * ------------------------------------------------------------- */
  function log(msg){
    if(!cfg.logEach) return; // –ï—Å–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–∫–ª—é—á–µ–Ω–æ (logEach = 0)
    const now = Date.now();
    if(now >= nextLog.value){ // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ª–æ–≥–∞
      console.log(`[AutoBoost v2] ${msg}`);
      nextLog.value = now + cfg.logEach*1000; // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π –ª–æ–≥
    }
  }

  /* ---------------------------------------------------------------
   * 10) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (UI) + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   * ------------------------------------------------------------- */
  let updateStatsUI = ()=>{}; // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI, –±—É–¥–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
  function renderUI(){
    if(document.querySelector('.gu-gear')) return; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ UI

    // CSS —Å—Ç–∏–ª–∏ –¥–ª—è UI
    const css = `
      .gu-gear{
        position:fixed;top:12px;right:12px;width:36px;height:36px;
        background:#1b1b25dd;border-radius:50%;display:flex;
        align-items:center;justify-content:center;cursor:pointer;
        z-index:9999;color:#8cf;font-size:20px;user-select:none;
        transition:transform .2s ease-in-out;}
      .gu-gear:hover{transform:rotate(45deg)}
      .gu-panel{
        position:fixed;top:56px;right:12px;width:340px;background:#1b1b25f2;
        padding:12px;border-radius:8px;font:13px/1.4 sans-serif;color:#cee;
        box-shadow:0 4px 8px rgba(0,0,0,.3);z-index:9998;}
      .gu-panel hr{border-color:#444;margin:8px 0}
      .gu-panel .row{display:flex;align-items:center;justify-content:space-between;margin:4px 0}
      .gu-panel .row label{flex:1;margin-right:8px;cursor:pointer}
      .gu-panel input[type=checkbox]{margin-right:5px;}
      .gu-panel input[type=number]{width:60px;padding:3px 5px;background:#111;color:#fee;
        border:1px solid #555;border-radius:4px;text-align:center;}
      .gu-panel button{width:100%;margin-top:8px;padding:6px 0;background:#444;border:none;
        border-radius:4px;color:#eee;cursor:pointer;transition:background-color .2s}
      .gu-panel button:hover{background:#555}
      .stat-value{font-weight:bold;color:#4caf50}`;

    // HTML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ UI
    const html = `
      <div class="gu-gear">‚öôÔ∏è</div>
      <div class="gu-panel" style="display:none">
        <div class="row"><label><input id="gu-enabled" type="checkbox"> –í–∫–ª—é—á–∏—Ç—å –≤—Å—ë (Master Switch)</label></div><hr/>
        <div class="row"><label><input id="gu-ac" type="checkbox"> Auto Collector</label></div>
        <div class="row"><label><input id="gu-sm" type="checkbox"> Shard Multiplier</label></div>
        <div class="row"><label><input id="gu-cb" type="checkbox"> Conveyor Booster</label></div><hr/>
        <div class="row"><label><input id="gu-farm" type="checkbox"> Auto Farm (8 —á)</label></div><hr/>
        <div class="row"><label><input id="gu-ka" type="checkbox"> Keep-Alive (–∞–Ω—Ç–∏-AFK)</label></div>
        <div class="row"><label><input id="gu-reload" type="checkbox"> –ê–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</label></div>
        <div class="row"><label>–ò–Ω—Ç–µ—Ä–≤–∞–ª (–º–∏–Ω)</label><input id="gu-reload-min" type="number" min="1"></div><hr/>
        <div class="row"><label>–õ–æ–≥ –≤ –∫–æ–Ω—Å–æ–ª—å –∫–∞–∂–¥—ã–µ (—Å)</label><input id="gu-log" type="number" min="0"></div><hr/>
        <div class="row"><label>–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫:</label><div id="st-rel" class="stat-value">0</div></div>
        <div class="row"><label>Collector –∫–ª–∏–∫–æ–≤:</label><div id="st-ac" class="stat-value">0</div></div>
        <div class="row"><label>Shard –∫–ª–∏–∫–æ–≤:</label><div id="st-sm" class="stat-value">0</div></div>
        <div class="row"><label>Booster –∫–ª–∏–∫–æ–≤:</label><div id="st-cb" class="stat-value">0</div></div>
        <div class="row"><label>Farm –∫–ª–∏–∫–æ–≤:</label><div id="st-farm" class="stat-value">0</div></div><hr/>
        <button id="gu-reset">–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
      </div>`;

    // –í—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∏ HTML –≤ DOM
    document.head.insertAdjacentHTML('beforeend',`<style>${css}</style>`);
    document.body.insertAdjacentHTML('beforeend',html);

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –ø–æ ID
    const $ = s=>document.querySelector(s);
    const gear¬† = $('.gu-gear');
    const panel = $('.gu-panel');

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ UI
    updateStatsUI = ()=>{
      $('#st-rel').textContent¬† = stats.reloadCount;
      $('#st-ac').textContent¬† ¬†= stats.clickCount.autoAC;
      $('#st-sm').textContent¬† ¬†= stats.clickCount.autoSM;
      $('#st-cb').textContent¬† ¬†= stats.clickCount.autoCB;
      $('#st-farm').textContent = stats.clickCount.autoFarm;
    };

    /** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è UI —Å —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π */
    function syncUI(){
      $('#gu-enabled').checked¬† ¬† ¬† = cfg.enabled;
      $('#gu-ac').checked¬† ¬† ¬† ¬† ¬† ¬†= cfg.autoAC;
      $('#gu-sm').checked¬† ¬† ¬† ¬† ¬† ¬†= cfg.autoSM;
      $('#gu-cb').checked¬† ¬† ¬† ¬† ¬† ¬†= cfg.autoCB;
      $('#gu-farm').checked¬† ¬† ¬† ¬† ¬†= cfg.autoFarm;
      $('#gu-ka').checked¬† ¬† ¬† ¬† ¬† ¬†= cfg.keepAlive;
      $('#gu-reload').checked¬† ¬† ¬† ¬†= cfg.autoReload;
      $('#gu-reload-min').value¬† ¬† ¬†= cfg.reloadMinutes;
      $('#gu-log').value¬† ¬† ¬† ¬† ¬† ¬† = cfg.logEach;
      updateStatsUI();
    }
    syncUI(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º UI —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

    /* –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ UI */
    $('#gu-enabled').onchange¬† ¬† ¬†= e=>{ cfg.enabled¬† ¬† ¬† ¬†= e.target.checked; saveConfig(); startAll(); };
    $('#gu-ac').onchange¬† ¬† ¬† ¬† ¬† = e=>{ cfg.autoAC¬† ¬† ¬† ¬† = e.target.checked; saveConfig(); };
    $('#gu-sm').onchange¬† ¬† ¬† ¬† ¬† = e=>{ cfg.autoSM¬† ¬† ¬† ¬† = e.target.checked; saveConfig(); };
    $('#gu-cb').onchange¬† ¬† ¬† ¬† ¬† = e=>{ cfg.autoCB¬† ¬† ¬† ¬† = e.target.checked; saveConfig(); };
    $('#gu-farm').onchange¬† ¬† ¬† ¬† = e=>{ cfg.autoFarm¬† ¬† ¬† = e.target.checked; saveConfig(); scheduleFarm(); };
    $('#gu-ka').onchange¬† ¬† ¬† ¬† ¬† = e=>{ cfg.keepAlive¬† ¬† ¬†= e.target.checked; saveConfig(); };
    $('#gu-reload').onchange¬† ¬† ¬† = e=>{ cfg.autoReload¬† ¬† = e.target.checked; saveConfig(); scheduleReload(); };
    $('#gu-reload-min').onchange¬† = e=>{ cfg.reloadMinutes = Math.max(1,~~e.target.value); saveConfig(); scheduleReload(); };
    $('#gu-log').onchange¬† ¬† ¬† ¬† ¬†= e=>{ cfg.logEach¬† ¬† ¬† ¬†= Math.max(0,~~e.target.value); saveConfig(); };

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
    $('#gu-reset').onclick = ()=>{
      Object.assign(cfg,DEF); // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      stats = { reloadCount:0, clickCount:{autoAC:0,autoSM:0,autoCB:0,autoFarm:0} }; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      saveConfig(); saveStats(); syncUI(); startAll(); scheduleFarm(); console.clear(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º, –æ–±–Ω–æ–≤–ª—è–µ–º UI, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã, –æ—á–∏—â–∞–µ–º –∫–æ–Ω—Å–æ–ª—å
      console.info('[AutoBoost v2] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω—ã.');
    };

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∏–∫–æ–Ω–∫–µ —à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞–Ω–µ–ª–∏
    gear.onclick = () => {
      panel.style.display = panel.style.display==='none' ? 'block' : 'none';
    };
  }

  /* ---------------------------------------------------------------
   * 11) –û—Ç—Ä–∏—Å–æ–≤–∫–∞ UI –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è <body>
   * ------------------------------------------------------------- */
  // –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∂–¥–µ—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è —Ç–µ–≥–∞ <body> –∏ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç –∫–æ–ª–±—ç–∫
  const waitBody = fn => document.body ? fn() : setTimeout(()=>waitBody(fn),50);
  waitBody(renderUI); // –†–∏—Å—É–µ–º UI —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è <body>

  // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º UI, –µ—Å–ª–∏ –æ–Ω –±—ã–ª —É–¥–∞–ª–µ–Ω —Å–∞–π—Ç–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ SPA –Ω–∞–≤–∏–≥–∞—Ü–∏–∏)
  setInterval(()=> !document.querySelector('.gu-gear') && renderUI(), 10000);

  /* ---------------------------------------------------------------
   * 12) –ù–∞—á–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞
   * ------------------------------------------------------------- */
  // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ª–∏–±–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM, –ª–∏–±–æ —Å—Ä–∞–∑—É, –µ—Å–ª–∏ DOM —É–∂–µ –≥–æ—Ç–æ–≤.
  if(document.readyState==='complete' || document.readyState==='interactive') init();
  else window.addEventListener('DOMContentLoaded', init, { once:true }); // –ò—Å–ø–æ–ª—å–∑—É–µ–º DOMContentLoaded –¥–ª—è –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞

  /* –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ DOM */
  // –ï—Å–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞),
  // –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–æ–∫ –±—É—Å—Ç–µ—Ä–æ–≤ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏.
  new MutationObserver(m=> m.some(x=>x.type==='childList') && startAll())
    .observe(document.documentElement,{childList:true,subtree:true});

})();
